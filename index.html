<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A1K50_PTT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(to bottom, #0a0e27 0%, #1a1444 50%, #2d1b69 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle linear infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        #snow {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
}

.snowflake {
    position: absolute;
    top: -20px;
    animation-name: fall;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
}

@keyframes fall {
    0% {
        transform: translateX(0) translateY(0);
    }
    100% {
        transform: translateX(var(--drift)) translateY(110vh);
    }
}


        .content {
            position: relative;
            z-index: 10;
        }
        .card {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }

        .floating {
            animation: float 3s ease-in-out infinite;
        }
        .preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 16px;
            max-height: 500px;
            overflow-y: auto;
            padding: 8px;
        }

        .preview-item {
            position: relative;
            width: 100%;
            height: 140px;
            animation: fadeIn 0.3s ease-out;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .preview-item:hover {
            transform: scale(1.08) rotate(2deg);
            z-index: 10;
        }

        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 12px;
            border: 3px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
        }

        .preview-item:hover img {
            box-shadow: 0 8px 30px rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.8);
        }

        .preview-item button {
            position: absolute;
            top: 8px;
            right: 8px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            opacity: 0;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
            cursor: pointer;
            font-size: 18px;
        }

        .preview-item:hover button {
            opacity: 1;
            transform: scale(1.1);
        }

        .preview-item button:hover {
            transform: scale(1.3) rotate(90deg);
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease-out;
        }
        .gallery-item {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .gallery-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s;
        }

        .gallery-item:hover::before {
            left: 100%;
        }

        .gallery-item:hover {
            transform: translateY(-6px) scale(1.02);
        }
        .upload-btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
        }

        .upload-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .upload-btn:hover::before {
            width: 400px;
            height: 400px;
        }

        .upload-btn:active {
            transform: scale(0.96);
        }
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        .shimmer {
            background: linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.3) 50%, rgba(255,255,255,0.1) 75%);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite;
        }
        input:focus, button:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(167, 139, 250, 0.5);
        }
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        .text-glow {
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5),
                         0 0 40px rgba(167, 139, 250, 0.3);
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    <div class="snow" id="snow"></div>
    <div class="content min-h-screen p-4 md:p-8">
        <div class="max-w-5xl mx-auto">
            <div class="card rounded-3xl p-8 md:p-10 mb-8">
                <div class="text-center mb-8">
                    <div class="inline-block floating">
                        <span class="text-6xl mb-4 block">üì∏</span>
                    </div>
                    <h1 class="text-4xl md:text-5xl font-black text-white text-glow mb-3">
                        A1K50-PTT
                    </h1>
                    <p class="text-gray-200 text-sm">h√£y t·∫£i ·∫£nh l√™n</p>
                </div>
                
                <div class="space-y-6">
                    <div class="group">
                        <label class="block text-sm font-bold text-white mb-3 flex items-center gap-2">
                            <span class="text-xl">üè¥‚Äç‚ò†Ô∏è</span>
                            <span>Th√¥ng tin ch√≠nh v·ªÅ ·∫£nh</span>
                        </label>
                        <input
                            type="text"
                            id="userName"
                            placeholder="Th√¥ng tin ch√≠nh v·ªÅ ·∫£nh..."
                            class="w-full px-5 py-4 bg-white/20 backdrop-blur-sm border-2 border-white/30 rounded-2xl focus:ring-4 focus:ring-purple-400 focus:border-white/50 text-lg transition-all duration-300 hover:border-white/40 text-white placeholder-gray-300"
                        />
                    </div>

                    <div class="group">
                        <label class="block text-sm font-bold text-white mb-3 flex items-center gap-2">
                            <span class="text-xl">üñºÔ∏è</span>
                            <span>Ch·ªçn ·∫£nh (ho·∫∑c Ctrl+V)</span>
                        </label>
                        <input
                            type="file"
                            id="fileInput"
                            accept="image/*"
                            multiple
                            class="w-full px-4 py-3 bg-white/20 backdrop-blur-sm border-2 border-white/30 rounded-2xl file:mr-4 file:py-3 file:px-6 file:rounded-xl file:border-0 file:bg-gradient-to-r file:from-purple-500 file:to-pink-500 file:text-white file:font-bold hover:file:from-purple-600 hover:file:to-pink-600 transition-all cursor-pointer hover:border-white/40 text-white"
                        />
                    </div>

                    <div id="previewContainer" class="hidden">
                        <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-5 border-2 border-white/20">
                            <p class="text-sm font-bold text-white mb-4 flex items-center gap-2">
                                <span class="text-lg">‚ú®</span>
                                <span>ƒê√£ ch·ªçn <span id="fileCount" class="text-yellow-300">0</span> ·∫£nh</span>
                            </p>
                            <div id="previewGrid" class="preview-grid"></div>
                        </div>
                    </div>

                    <div id="uploadProgress" class="text-center hidden">
                        <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 border-2 border-white/20">
                            <div class="shimmer h-3 rounded-full mb-3"></div>
                            <p class="text-white font-bold text-lg"></p>
                        </div>
                    </div>

                    <button
                        id="uploadBtn"
                        class="upload-btn w-full bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 text-white py-5 rounded-2xl font-black text-xl hover:shadow-2xl disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:-translate-y-1 active:translate-y-0"
                    >
                        <span class="flex items-center justify-center gap-3 relative z-10">
                            <span class="text-2xl">üòé</span>
                            <span>T·∫£i l√™n ngay</span>
                        </span>
                    </button>
                </div>
            </div>

            <!-- Gallery -->
            <div class="card rounded-3xl p-8 md:p-10 border-2 border-white/30">
                <div class="text-center mb-8">
                    <h2 class="text-3xl md:text-4xl font-black text-white text-glow mb-3 flex items-center justify-center gap-3">
                        <span class="text-4xl">üí©</span>
                        <span>Th∆∞ vi·ªán ·∫£nh</span>
                    </h2>
                    <p class="text-gray-200">
                        <span class="inline-block bg-gradient-to-r from-purple-600 to-pink-600 text-white px-5 py-2 rounded-full font-bold text-lg shadow-lg">
                            <span id="galleryCount">0</span> ·∫£nh
                        </span>
                    </p>
                </div>
                
                <div id="gallery" class="space-y-4">
                    <div class="text-center py-20">
                        <div class="floating text-6xl mb-4">üé≠</div>
                        <p class="text-xl text-white font-medium">Ch∆∞a c√≥ ·∫£nh n√†o</p>
                        <p class="text-sm text-gray-300 mt-2">H√£y t·∫£i ·∫£nh ƒë·∫ßu ti√™n l√™n nh√©!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Viewer -->
    <div id="modal" class="modal">
        <button id="closeModal" class="absolute top-6 right-6 bg-white/90 backdrop-blur-sm text-black p-4 rounded-2xl hover:bg-white transition-all shadow-2xl z-10 font-bold text-xl hover:rotate-90 duration-300 border-none cursor-pointer">
            ‚úï
        </button>
        <button id="prevBtn" class="absolute left-6 bg-white/90 backdrop-blur-sm text-black p-4 rounded-2xl hover:bg-white transition-all shadow-2xl z-10 text-2xl hover:scale-110 duration-300 border-none cursor-pointer">
            ‚Äπ
        </button>
        <button id="nextBtn" class="absolute right-6 bg-white/90 backdrop-blur-sm text-black p-4 rounded-2xl hover:bg-white transition-all shadow-2xl z-10 text-2xl hover:scale-110 duration-300 border-none cursor-pointer">
            ‚Ä∫
        </button>
        
        <div class="flex flex-col items-center max-w-6xl px-4">
            <img id="modalImage" class="max-w-full max-h-[70vh] object-contain rounded-2xl shadow-2xl border-4 border-white" />
            <div class="mt-6 bg-white/95 backdrop-blur-md rounded-2xl px-8 py-5 shadow-2xl">
                <p id="modalName" class="font-black text-2xl bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent text-center"></p>
                <p id="modalTime" class="text-sm text-gray-600 text-center mt-2"></p>
            </div>
            <p id="modalCounter" class="text-white mt-4 bg-black/50 backdrop-blur-sm px-5 py-2 rounded-full font-bold"></p>
        </div>
    </div>

    <script>
        const CLOUD_NAME = 'dbyap7mw2';
        const UPLOAD_PRESET = 'A1K50_PTT';
        
        let selectedFiles = [];
        let images = [];
        let currentViewIndex = 0;
        function createStars() {
            const starsContainer = document.getElementById('stars');
            const starCount = 200;
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                const size = Math.random() * 3 + 1;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDuration = (Math.random() * 3 + 2) + 's';
                star.style.animationDelay = Math.random() * 3 + 's';
                
                starsContainer.appendChild(star);
            }
        }

        function createSnowflakes() {
    const snowContainer = document.getElementById('snow');
    const snowflakeCount = 80;

    for (let i = 0; i < snowflakeCount; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        snowflake.textContent = '‚ùÑ';
        snowflake.style.left = Math.random() * 100 + '%';
        const fallDuration = Math.random() * 4 + 4; // 4‚Äì8s
        snowflake.style.animationDuration = fallDuration + 's';
        snowflake.style.animationDelay = Math.random() * 4 + 's';
        snowflake.style.fontSize = (Math.random() * 12 + 8) + 'px';
        snowflake.style.opacity = (Math.random() * 0.5 + 0.5);
        snowflake.style.setProperty('--drift', (Math.random() * 20 - 10) + 'px');
        setTimeout(() => snowflake.remove(), (fallDuration + 5) * 1000);
        snowContainer.appendChild(snowflake);
    }
}

        createStars();
        createSnowflakes();
        loadImages();
        document.getElementById('fileInput').addEventListener('change', (e) => {
            handleFiles(Array.from(e.target.files));
        });

        document.addEventListener('paste', (e) => {
            const items = e.clipboardData.items;
            const files = [];
            for (let i = 0; i < items.length; i++) {
                if (items[i].type.indexOf('image') !== -1) {
                    files.push(items[i].getAsFile());
                }
            }
            if (files.length > 0) {
                handleFiles(files);
                e.preventDefault();
            }
        });

        document.getElementById('uploadBtn').addEventListener('click', uploadImages);
        document.getElementById('closeModal').addEventListener('click', () => {
            document.getElementById('modal').classList.remove('active');
        });
        document.getElementById('prevBtn').addEventListener('click', () => {
            currentViewIndex = (currentViewIndex - 1 + images.length) % images.length;
            showImage(currentViewIndex);
        });
        document.getElementById('nextBtn').addEventListener('click', () => {
            currentViewIndex = (currentViewIndex + 1) % images.length;
            showImage(currentViewIndex);
        });

        document.addEventListener('keydown', (e) => {
            if (document.getElementById('modal').classList.contains('active')) {
                if (e.key === 'Escape') {
                    document.getElementById('modal').classList.remove('active');
                } else if (e.key === 'ArrowLeft') {
                    currentViewIndex = (currentViewIndex - 1 + images.length) % images.length;
                    showImage(currentViewIndex);
                } else if (e.key === 'ArrowRight') {
                    currentViewIndex = (currentViewIndex + 1) % images.length;
                    showImage(currentViewIndex);
                }
            }
        });

        function handleFiles(files) {
            const imageFiles = files.filter(f => f.type.startsWith('image/'));
            selectedFiles = [...selectedFiles, ...imageFiles];
            updatePreview();
        }

        function updatePreview() {
            const container = document.getElementById('previewContainer');
            const grid = document.getElementById('previewGrid');
            const count = document.getElementById('fileCount');
            
            if (selectedFiles.length === 0) {
                container.classList.add('hidden');
                return;
            }

            container.classList.remove('hidden');
            count.textContent = selectedFiles.length;
            grid.innerHTML = '';

            selectedFiles.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const div = document.createElement('div');
                    div.className = 'preview-item';
                    div.innerHTML = `
                        <img src="${e.target.result}" alt="Preview ${index + 1}">
                        <button onclick="removeFile(${index})">‚úï</button>
                    `;
                    grid.appendChild(div);
                };
                reader.readAsDataURL(file);
            });
        }

        window.removeFile = function(index) {
            selectedFiles.splice(index, 1);
            updatePreview();
        }

        async function uploadImages() {
            const name = document.getElementById('userName').value.trim();
            
            if (selectedFiles.length === 0 || !name) {
                alert('nh·∫≠p t√™n v√† ch·ªçn ·∫£nh!');
                return;
            }

            const btn = document.getElementById('uploadBtn');
            const progress = document.getElementById('uploadProgress');
            
            btn.disabled = true;
            progress.classList.remove('hidden');

            let uploadedCount = 0;
            const totalFiles = selectedFiles.length;

            for (let i = 0; i < totalFiles; i++) {
                progress.innerHTML = `
                    <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 border-2 border-white/20">
                        <div class="shimmer h-3 rounded-full mb-3"></div>
                        <p class="text-white font-bold text-lg">ƒêang t·∫£i ${i + 1}/${totalFiles}... ‚è≥</p>
                    </div>
                `;

                const formData = new FormData();
                formData.append('file', selectedFiles[i]);
                formData.append('upload_preset', UPLOAD_PRESET);

                try {
                    const response = await fetch(
                        `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`,
                        { method: 'POST', body: formData }
                    );

                    const data = await response.json();
                    
                    if (data.secure_url) {
                        const newImage = {
                            id: `${data.public_id}_${Date.now()}_${i}`,
                            url: data.secure_url,
                            name: name,
                            timestamp: Date.now() + i
                        };

                        localStorage.setItem(`img:${newImage.id}`, JSON.stringify(newImage));
                        images.unshift(newImage);
                        uploadedCount++;
                    }

                    await new Promise(resolve => setTimeout(resolve, 500));
                } catch (error) {
                    console.error('Upload error:', error);
                }
            }

            selectedFiles = [];
            document.getElementById('fileInput').value = '';
            document.getElementById('userName').value = '';
            updatePreview();
            progress.classList.add('hidden');
            btn.disabled = false;
            
            alert(`ƒê√£ t·∫£i ·∫£nh th√†nh c√¥ng!`);
            renderGallery();
        }

        function loadImages() {
            images = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('img:')) {
                    const img = JSON.parse(localStorage.getItem(key));
                    images.push(img);
                }
            }
            images.sort((a, b) => b.timestamp - a.timestamp);
            renderGallery();
        }

        function renderGallery() {
            const gallery = document.getElementById('gallery');
            const count = document.getElementById('galleryCount');
            
            count.textContent = images.length;

            if (images.length === 0) {
                gallery.innerHTML = `
                    <div class="text-center py-20">
                        <div class="floating text-6xl mb-4"></div>
                        <p class="text-xl text-white font-medium">Ch∆∞a c√≥ ·∫£nh n√†o</p>
                        <p class="text-sm text-gray-300 mt-2">H√£y t·∫£i ·∫£nh ...</p>
                    </div>
                `;
                return;
            }

            gallery.innerHTML = images.map((img, index) => `
                <div onclick="openModal(${index})" class="gallery-item bg-white/10 backdrop-blur-sm rounded-2xl p-5 shadow-lg hover:shadow-2xl transition-all border-2 border-white/20 hover:border-white/40">
                    <div class="flex items-center gap-5">
                        <div class="relative group flex-shrink-0">
                            <img src="${img.url}" alt="${img.name}" class="w-24 h-24 object-cover rounded-xl border-3 border-white/50 shadow-lg group-hover:scale-110 transition-transform duration-300">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent rounded-xl opacity-0 group-hover:opacity-100 transition-opacity flex items-end justify-center pb-2">
                                <span class="text-white text-xs font-bold">üëÅÔ∏è Xem</span>
                            </div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="font-black text-xl text-white truncate">${img.name}</p>
                            <p class="text-sm text-gray-300 mt-1 flex items-center gap-2">
                                <span>üïê</span>
                                <span>${formatTimeAgo(img.timestamp)}</span>
                            </p>
                        </div>
                        <div class="hidden md:flex items-center gap-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white px-5 py-3 rounded-xl font-bold shadow-lg group-hover:scale-105 transition-transform flex-shrink-0">
                            <span>Xem</span>
                            <span class="text-xl">‚Üí</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        window.openModal = function(index) {
            currentViewIndex = index;
            showImage(index);
            document.getElementById('modal').classList.add('active');
        }

        function showImage(index) {
            const img = images[index];
            document.getElementById('modalImage').src = img.url;
            document.getElementById('modalName').textContent = img.name;
            document.getElementById('modalTime').textContent = formatTimeAgo(img.timestamp);
            document.getElementById('modalCounter').textContent = `${index + 1} / ${images.length}`;
        }

        function formatTimeAgo(timestamp) {
            const now = Date.now();
            const diff = now - timestamp;
            const seconds = Math.floor(diff / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);

            if (days > 0) return `${days} ng√†y tr∆∞·ªõc`;
            if (hours > 0) return `${hours} gi·ªù tr∆∞·ªõc`;
            if (minutes > 0) return `${minutes} ph√∫t tr∆∞·ªõc`;
            return 'V·ª´a xong';
        }
    </script>
</body>
</html>
